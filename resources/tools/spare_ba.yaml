name: spare_ba
description: This tool takes an unharmonized DLMUSE CSV (and demographics information) and uses SPARE to produce a brain age estimate.

inputs:
  dlmuse_vol:
    type: file
  demog_csv:
    type: file

outputs:
  spare_ba_csv:
    type: file


mounts:
  demog_csv:
    path_in_container: /input/demographics.csv
    mode: ro
  dlmuse_vol:
    path_in_container: /input/dlmuse_vol.csv
    mode: ro
  spare_ba_csv:
    path_in_container: /output/SPARE_BA.csv
    mode: rw
  
parameters:
  {} # Empty dictionary to signify no parameters

resources: # Used to allocate jobs on the cloud. Please be diligent.
  vcpus: 2
  memory: 8000 # Amount must be in MiB, see https://docs.aws.amazon.com/batch/latest/APIReference/API_ResourceRequirement.html
  gpus: 0

container:
  image: cbica/nichart_spare_score:0.0.2
  command: "-i {dlmuse_vol} -demog {demog_csv} -t RG -m /spare_score/Models/final_models/SPARE-BA-RAW-linear_fast-HT-BC.joblib -o {spare_ba_csv}"

